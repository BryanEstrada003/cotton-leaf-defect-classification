2025-11-09 15:22:43,787 - INFO - Modelo SBTAYLOR_KAN.Net importado correctamente.
2025-11-09 15:22:43,788 - INFO - Los pesos del modelo se guardarán en: 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:22:43,789 - INFO - El registro de entrenamiento se guardará en: 'models/sbtaylor_kan_cotton\run_20251109_152243\training_run.log'
2025-11-09 15:22:44,771 - INFO - Versión de PyTorch: 2.9.0+cu126
2025-11-09 15:22:44,810 - INFO - ¿CUDA está disponible?: True
2025-11-09 15:22:44,812 - INFO - Versión de CUDA con la que PyTorch fue compilado: 12.6
2025-11-09 15:22:44,814 - INFO - Número de GPUs disponibles: 1
2025-11-09 15:22:44,821 - INFO - Nombre de la GPU actual: NVIDIA GeForce RTX 4090
2025-11-09 15:22:46,128 - INFO - --- Hyperparámetros de Entrenamiento ---
2025-11-09 15:22:46,131 - INFO - Batch Size: 32
2025-11-09 15:22:46,133 - INFO - Num Epochs: 300
2025-11-09 15:22:46,135 - INFO - Learning Rate: 0.0001
2025-11-09 15:22:46,136 - INFO - Num Classes: 4
2025-11-09 15:22:46,137 - INFO - Num Workers: 4
2025-11-09 15:23:16,362 - INFO - 
Cargando dataset de ./data...
2025-11-09 15:23:16,413 - INFO - Dataset cargado exitosamente.
2025-11-09 15:23:16,414 - INFO -   - 5212 imágenes de entrenamiento.
2025-11-09 15:23:16,416 - INFO -   - 240 imágenes de validación.
2025-11-09 15:23:24,357 - INFO - 
Usando dispositivo: cuda
2025-11-09 15:31:50,121 - INFO - Aplicando pesos de clase a la función de pérdida CrossEntropyLoss.
2025-11-09 15:31:50,190 - INFO - 
--- INICIANDO ENTRENAMIENTO ---
2025-11-09 15:31:50,193 - INFO - 
--- Época 1/300 ---
2025-11-09 15:32:46,092 - INFO - Entrenamiento | Pérdida: 1.4209, Accuracy: 0.4211, Tiempo: 55.90s
2025-11-09 15:32:53,776 - INFO - Validación    | Pérdida: 88729.9208, Accuracy: 0.2917
2025-11-09 15:32:54,201 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:32:54,203 - INFO - 
--- Época 2/300 ---
2025-11-09 15:33:49,039 - INFO - Entrenamiento | Pérdida: 1.1174, Accuracy: 0.5177, Tiempo: 54.83s
2025-11-09 15:33:56,687 - INFO - Validación    | Pérdida: 63551.5683, Accuracy: 0.3417
2025-11-09 15:33:57,054 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:33:57,056 - INFO - 
--- Época 3/300 ---
2025-11-09 15:34:51,526 - INFO - Entrenamiento | Pérdida: 1.0055, Accuracy: 0.5587, Tiempo: 54.47s
2025-11-09 15:34:59,303 - INFO - Validación    | Pérdida: 39011.6492, Accuracy: 0.2958
2025-11-09 15:34:59,658 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:34:59,659 - INFO - 
--- Época 4/300 ---
2025-11-09 15:35:55,315 - INFO - Entrenamiento | Pérdida: 0.9553, Accuracy: 0.5606, Tiempo: 55.65s
2025-11-09 15:36:02,827 - INFO - Validación    | Pérdida: 371563.1529, Accuracy: 0.3083
2025-11-09 15:36:02,828 - INFO - 
--- Época 5/300 ---
2025-11-09 15:36:58,231 - INFO - Entrenamiento | Pérdida: 0.9601, Accuracy: 0.5537, Tiempo: 55.40s
2025-11-09 15:37:06,040 - INFO - Validación    | Pérdida: 396623.0198, Accuracy: 0.2500
2025-11-09 15:37:06,042 - INFO - 
--- Época 6/300 ---
2025-11-09 15:38:00,694 - INFO - Entrenamiento | Pérdida: 0.9432, Accuracy: 0.5677, Tiempo: 54.65s
2025-11-09 15:38:08,340 - INFO - Validación    | Pérdida: 65499.8128, Accuracy: 0.2750
2025-11-09 15:38:08,341 - INFO - 
--- Época 7/300 ---
2025-11-09 15:39:03,495 - INFO - Entrenamiento | Pérdida: 0.9252, Accuracy: 0.5733, Tiempo: 55.15s
2025-11-09 15:39:11,038 - INFO - Validación    | Pérdida: 38677.5335, Accuracy: 0.3292
2025-11-09 15:39:11,408 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:39:11,409 - INFO - 
--- Época 8/300 ---
2025-11-09 15:40:06,438 - INFO - Entrenamiento | Pérdida: 0.8937, Accuracy: 0.5860, Tiempo: 55.03s
2025-11-09 15:40:14,075 - INFO - Validación    | Pérdida: 179800.3474, Accuracy: 0.3417
2025-11-09 15:40:14,076 - INFO - 
--- Época 9/300 ---
2025-11-09 15:41:09,060 - INFO - Entrenamiento | Pérdida: 0.9173, Accuracy: 0.5698, Tiempo: 54.98s
2025-11-09 15:41:16,948 - INFO - Validación    | Pérdida: 56767.0779, Accuracy: 0.2958
2025-11-09 15:41:16,950 - INFO - 
--- Época 10/300 ---
2025-11-09 15:42:12,269 - INFO - Entrenamiento | Pérdida: 0.8796, Accuracy: 0.5783, Tiempo: 55.32s
2025-11-09 15:42:19,942 - INFO - Validación    | Pérdida: 50763.3614, Accuracy: 0.2958
2025-11-09 15:42:19,944 - INFO - 
--- Época 11/300 ---
2025-11-09 15:43:15,397 - INFO - Entrenamiento | Pérdida: 0.8627, Accuracy: 0.5934, Tiempo: 55.45s
2025-11-09 15:43:23,117 - INFO - Validación    | Pérdida: 23054.1208, Accuracy: 0.2708
2025-11-09 15:43:23,477 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:43:23,479 - INFO - 
--- Época 12/300 ---
2025-11-09 15:44:19,621 - INFO - Entrenamiento | Pérdida: 0.8682, Accuracy: 0.5936, Tiempo: 56.14s
2025-11-09 15:44:27,175 - INFO - Validación    | Pérdida: 49048.1332, Accuracy: 0.3083
2025-11-09 15:44:27,176 - INFO - 
--- Época 13/300 ---
2025-11-09 15:45:21,816 - INFO - Entrenamiento | Pérdida: 0.8488, Accuracy: 0.6044, Tiempo: 54.64s
2025-11-09 15:45:29,358 - INFO - Validación    | Pérdida: 54753.0990, Accuracy: 0.2917
2025-11-09 15:45:29,359 - INFO - 
--- Época 14/300 ---
2025-11-09 15:46:25,254 - INFO - Entrenamiento | Pérdida: 0.8463, Accuracy: 0.6090, Tiempo: 55.89s
2025-11-09 15:46:32,780 - INFO - Validación    | Pérdida: 83355.4617, Accuracy: 0.2958
2025-11-09 15:46:32,782 - INFO - 
--- Época 15/300 ---
2025-11-09 15:47:26,587 - INFO - Entrenamiento | Pérdida: 0.8651, Accuracy: 0.6076, Tiempo: 53.80s
2025-11-09 15:47:34,227 - INFO - Validación    | Pérdida: 41169.2806, Accuracy: 0.3208
2025-11-09 15:47:34,229 - INFO - Tasa de aprendizaje reducida de 0.0001 a 1e-05
2025-11-09 15:47:34,231 - INFO - 
--- Época 16/300 ---
2025-11-09 15:48:29,308 - INFO - Entrenamiento | Pérdida: 0.7852, Accuracy: 0.6224, Tiempo: 55.07s
2025-11-09 15:48:36,813 - INFO - Validación    | Pérdida: 20936.7412, Accuracy: 0.3375
2025-11-09 15:48:37,151 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:48:37,154 - INFO - 
--- Época 17/300 ---
2025-11-09 15:49:32,614 - INFO - Entrenamiento | Pérdida: 0.7626, Accuracy: 0.6372, Tiempo: 55.46s
2025-11-09 15:49:40,176 - INFO - Validación    | Pérdida: 24917.3843, Accuracy: 0.2667
2025-11-09 15:49:40,177 - INFO - 
--- Época 18/300 ---
2025-11-09 15:50:35,684 - INFO - Entrenamiento | Pérdida: 0.7753, Accuracy: 0.6303, Tiempo: 55.51s
2025-11-09 15:50:43,281 - INFO - Validación    | Pérdida: 19028.3807, Accuracy: 0.3250
2025-11-09 15:50:43,653 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:50:43,655 - INFO - 
--- Época 19/300 ---
2025-11-09 15:51:39,002 - INFO - Entrenamiento | Pérdida: 0.7606, Accuracy: 0.6410, Tiempo: 55.35s
2025-11-09 15:51:46,439 - INFO - Validación    | Pérdida: 16963.1617, Accuracy: 0.2958
2025-11-09 15:51:46,803 - INFO - [+] Mejora en val_loss. Guardando el mejor modelo en 'models/sbtaylor_kan_cotton\run_20251109_152243\sbtaylor_kan.best_weights.pth'
2025-11-09 15:51:46,804 - INFO - 
--- Época 20/300 ---
2025-11-09 15:52:40,924 - INFO - Entrenamiento | Pérdida: 0.7504, Accuracy: 0.6479, Tiempo: 54.12s
2025-11-09 15:52:48,528 - INFO - Validación    | Pérdida: 47919.5476, Accuracy: 0.2917
2025-11-09 15:52:48,530 - INFO - 
--- Época 21/300 ---
2025-11-09 15:53:42,759 - INFO - Entrenamiento | Pérdida: 0.7442, Accuracy: 0.6485, Tiempo: 54.23s
2025-11-09 15:53:50,104 - INFO - Validación    | Pérdida: 18915.1225, Accuracy: 0.3042
2025-11-09 15:53:50,106 - INFO - 
--- Época 22/300 ---
2025-11-09 15:54:43,504 - INFO - Entrenamiento | Pérdida: 0.7489, Accuracy: 0.6429, Tiempo: 53.40s
2025-11-09 15:54:51,034 - INFO - Validación    | Pérdida: 17333.3990, Accuracy: 0.3000
2025-11-09 15:54:51,035 - INFO - 
--- Época 23/300 ---
2025-11-09 15:55:46,118 - INFO - Entrenamiento | Pérdida: 0.7459, Accuracy: 0.6506, Tiempo: 55.08s
2025-11-09 15:55:53,579 - INFO - Validación    | Pérdida: 66696.0013, Accuracy: 0.3042
2025-11-09 15:55:53,582 - INFO - Tasa de aprendizaje reducida de 1e-05 a 1.0000000000000002e-06
2025-11-09 15:55:53,583 - INFO - 
--- Época 24/300 ---
2025-11-09 15:56:48,236 - INFO - Entrenamiento | Pérdida: 0.7374, Accuracy: 0.6472, Tiempo: 54.65s
2025-11-09 15:56:55,692 - INFO - Validación    | Pérdida: 36729.1319, Accuracy: 0.3000
2025-11-09 15:56:55,694 - INFO - 
--- Época 25/300 ---
2025-11-09 15:57:56,593 - INFO - Entrenamiento | Pérdida: 0.7385, Accuracy: 0.6543, Tiempo: 60.90s
2025-11-09 15:58:14,728 - INFO - Validación    | Pérdida: 36526.3944, Accuracy: 0.3000
2025-11-09 15:58:14,732 - INFO - 
--- Época 26/300 ---
2025-11-09 15:59:27,662 - INFO - Entrenamiento | Pérdida: 0.7419, Accuracy: 0.6537, Tiempo: 72.93s
2025-11-09 15:59:46,924 - INFO - Validación    | Pérdida: 109688.9858, Accuracy: 0.2792
2025-11-09 15:59:46,926 - INFO - 
--- Época 27/300 ---
2025-11-09 16:01:38,495 - INFO - Entrenamiento | Pérdida: 0.7329, Accuracy: 0.6529, Tiempo: 111.57s
2025-11-09 16:01:56,982 - INFO - Validación    | Pérdida: 24653.2183, Accuracy: 0.2917
2025-11-09 16:01:56,983 - INFO - Tasa de aprendizaje reducida de 1.0000000000000002e-06 a 1.0000000000000002e-07
2025-11-09 16:01:56,984 - INFO - 
--- Época 28/300 ---
2025-11-09 16:03:48,798 - INFO - Entrenamiento | Pérdida: 0.7358, Accuracy: 0.6617, Tiempo: 111.81s
